<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-how-it-works" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">How It Works | Divvi Up</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.divviup.org/how-it-works"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How It Works | Divvi Up"><meta data-rh="true" name="description" content="Learn how Divvi Up works and how it protects privacy."><meta data-rh="true" property="og:description" content="Learn how Divvi Up works and how it protects privacy."><link data-rh="true" rel="icon" href="/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.divviup.org/how-it-works"><link data-rh="true" rel="alternate" href="https://docs.divviup.org/how-it-works" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.divviup.org/how-it-works" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.31c159ce.css">
<script src="/assets/js/runtime~main.d843fe84.js" defer="defer"></script>
<script src="/assets/js/main.a37caf86.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo.svg" alt="Divvi Up Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/logo.svg" alt="Divvi Up Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Documentation</a><a href="https://app.divviup.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Divvi Up<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/divviup" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/how-it-works">How It Works</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/product-documentation/">Product Documentation</a><button aria-label="Expand sidebar category &#x27;Product Documentation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/references/">References</a><button aria-label="Expand sidebar category &#x27;References&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://divviup.github.io/divviup-ts" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Resources</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How It Works</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>How It Works</h1>
<p>Learn how Divvi Up works and how it protects privacy.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown">Breakdown<a href="#breakdown" class="hash-link" aria-label="Direct link to Breakdown" title="Direct link to Breakdown">​</a></h2>
<p>Divvi Up ingests measurements and aggregates them, while protecting the privacy
of each individual measurement. This can be broadly broken down into several
steps, described in the following sections.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/how-it-works-c07678e2ebf0b7b8dd042ae8ebe15462.png#gh-dark-mode-only" width="6714" height="1693" class="img_ev3q">
<img decoding="async" loading="lazy" src="/assets/images/how-it-works-light-233bb525a2e810522fa99c3b87ff8b9d.jpg#gh-light-mode-only" width="1477" height="382" class="img_ev3q"></p>
<p>See the <a href="https://datatracker.ietf.org/doc/draft-ietf-ppm-dap/" target="_blank" rel="noopener noreferrer">Distributed Aggregation Protocol (DAP)</a> for a highly detailed
specification of the protocol that underpins Divvi Up.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-0-subscriber-sets-up-divvi-up">Step 0: Subscriber sets up Divvi Up<a href="#step-0-subscriber-sets-up-divvi-up" class="hash-link" aria-label="Direct link to Step 0: Subscriber sets up Divvi Up" title="Direct link to Step 0: Subscriber sets up Divvi Up">​</a></h3>
<p>Subscribers are users of Divvi Up, such as app developers, who wish to collect
quantitative measurements about their end-user applications.</p>
<p>The subscriber chooses a DAP client library, which is used to interact with any
DAP-compatible measurements aggregator, such as the aggregators provided by
Divvi Up and its partners. Client libraries for <a href="https://crates.io/crates/janus_client" target="_blank" rel="noopener noreferrer">Rust
(janus_client)</a> and <a href="https://github.com/divviup/divviup-ts" target="_blank" rel="noopener noreferrer">TypeScript (divviup-ts)</a> are
available.</p>
<p>For each measurement the subscriber wishes to aggregate, the subscriber creates
a task. A task contains metadata about how the measurement will be made, which
aggregators will be used, and which aggregation function to use. The task&#x27;s
parameters are shared with both aggregators.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-client-generates-measurements">Step 1: Client generates measurements<a href="#step-1-client-generates-measurements" class="hash-link" aria-label="Direct link to Step 1: Client generates measurements" title="Direct link to Step 1: Client generates measurements">​</a></h3>
<p>The subscriber writes and deploys app functionality that takes measurements
corresponding to each task. They invoke a DAP client library and provide some of
the task parameters to it, such as the task identifier, measurement type, and
the aggregator servers being used.</p>
<p>For each measurement, the subsequent steps are performed.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-client-shards-the-measurement">Step 2: Client shards the measurement<a href="#step-2-client-shards-the-measurement" class="hash-link" aria-label="Direct link to Step 2: Client shards the measurement" title="Direct link to Step 2: Client shards the measurement">​</a></h3>
<p>The app uses the DAP client library to randomly shard the measurement into two
parts, known as report shares. One report share is for the leader aggregator,
and the other for the helper aggregator.</p>
<p>The client library encrypts each share with a public key advertised by the
respective aggregator.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-client-sends-shares-to-the-aggregators">Step 3: Client sends shares to the aggregators<a href="#step-3-client-sends-shares-to-the-aggregators" class="hash-link" aria-label="Direct link to Step 3: Client sends shares to the aggregators" title="Direct link to Step 3: Client sends shares to the aggregators">​</a></h3>
<p>The DAP client library sends the report shares via HTTPS to the leader
aggregator.</p>
<p>The leader relays the helper&#x27;s share to the helper. Because the helper&#x27;s report
share is encrypted to the helper, the leader cannot read it or reconstitute the
original measurement.</p>
<p>Each aggregator is operated by different organizations. Often, Divvi Up will act
as the leader, while another organization operates as a helper.</p>
<p>Crucially, these organizations are non-colluding. They don&#x27;t directly share
report shares or otherwise conspire to defeat the protocol. DAP guarantees that
as long as at least one of the aggregators operates according to the protocol,
the privacy of each individual measurement will be protected.</p>
<p>If you don&#x27;t wish to use any of the already-available third-party organizations
that Divvi Up partners with, you can self-host your own helper aggregator.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-aggregators-perform-aggregation">Step 4: Aggregators perform aggregation<a href="#step-4-aggregators-perform-aggregation" class="hash-link" aria-label="Direct link to Step 4: Aggregators perform aggregation" title="Direct link to Step 4: Aggregators perform aggregation">​</a></h3>
<p>Both aggregators work together to reject out-of-range or invalid measurements,
without revealing the report shares to each other and without any knowledge of
the originally submitted measurements. They do this by exchanging <a href="https://en.wikipedia.org/wiki/Zero-knowledge_proof" target="_blank" rel="noopener noreferrer">zero
knowledge proofs (ZKP)</a> based on their report share.</p>
<p>The principle behind this is <a href="https://en.wikipedia.org/wiki/Secure_multi-party_computation" target="_blank" rel="noopener noreferrer">multi-party computation</a>. The MPC protocol is
described in DAP and the ZKP cryptography is described in <a href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-vdaf/" target="_blank" rel="noopener noreferrer">Verifiable
Distributed Aggregation Functions (VDAF)</a>.</p>
<p>After validation, each aggregator independently executes the aggregation
function. For most measurement types, this will be summation.</p>
<p>At the end of the process, each aggregator will have computed a share of the
overall aggregate. Neither share reveals information about the final aggregate.</p>
<p>Each aggregator stores its aggregate share until the next step.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-subscriber-collects-aggregate-measurements">Step 5: Subscriber collects aggregate measurements<a href="#step-5-subscriber-collects-aggregate-measurements" class="hash-link" aria-label="Direct link to Step 5: Subscriber collects aggregate measurements" title="Direct link to Step 5: Subscriber collects aggregate measurements">​</a></h3>
<p>The subscriber operates a collector, which queries each aggregator to collect
the aggregate shares. Depending on the query type, this could be a query over a
time interval, or for an arbitrary batch of reports.</p>
<p>Aggregates often aren&#x27;t available immediately, depending on the measurement
type. The collector will poll the aggregator until it&#x27;s ready.</p>
<p>Each aggregate share is encrypted to the collector. The collector combines the
aggregate shares, yielding the aggregate result, the number of reports included
in the result, and the time interval that the result spans.</p>
<p>The collector only communicates with the leader. The leader relays the helper&#x27;s
aggregate share to the collector. Because each share is encrypted to the
collector, the leader cannot read the aggregate shares or reconstitute the
aggregate.</p>
<p>Off-the-shelf collectors that more elegantly handle the collection process and
presentation of data are currently in development.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/divviup/public-docs/tree/main/docs/how-it-works.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/product-documentation/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Product Documentation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#breakdown" class="table-of-contents__link toc-highlight">Breakdown</a><ul><li><a href="#step-0-subscriber-sets-up-divvi-up" class="table-of-contents__link toc-highlight">Step 0: Subscriber sets up Divvi Up</a></li><li><a href="#step-1-client-generates-measurements" class="table-of-contents__link toc-highlight">Step 1: Client generates measurements</a></li><li><a href="#step-2-client-shards-the-measurement" class="table-of-contents__link toc-highlight">Step 2: Client shards the measurement</a></li><li><a href="#step-3-client-sends-shares-to-the-aggregators" class="table-of-contents__link toc-highlight">Step 3: Client sends shares to the aggregators</a></li><li><a href="#step-4-aggregators-perform-aggregation" class="table-of-contents__link toc-highlight">Step 4: Aggregators perform aggregation</a></li><li><a href="#step-5-subscriber-collects-aggregate-measurements" class="table-of-contents__link toc-highlight">Step 5: Subscriber collects aggregate measurements</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Internet Security Research Group. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>